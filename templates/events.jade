extends layout

block prepend title
  | #{page.title} - 

block header
  h1 Events
  p.lead
    | Talks, tutorials, tours and visits, it is your call; let us know if you have an idea for an event.

block content
  - var events = _.chain(contents.events._.directories).map(function(item) {
  -   return item.index
  - }).compact().groupBy(function(item) {
  -   return item.date.getFullYear()
  - }).value()
  - var years = _.chain(events).keys().reverse().value()

  h1
    | Google calendar
  | Our calendar is available in multiple ways.
  ul
    li
      a(href="https://www.google.com/calendar/embed?src=imperialacm%40gmail.com&ctz=Europe/London")
        | Use HTML page of our calendar
    li
      | Import our calendar into your Google calendar. Click the arrow next to "Other calendars"
      | then choose "Add by URL". Use the following URL
      code
        | https://www.google.com/calendar/feeds/imperialacm%40gmail.com/public/basic

  each year in years
    each event in _.sortBy(events[year], function(item) { return -item.date })
      article.event
        header
          p.date
            span= moment(event.metadata.date).format('MMM Do, YYYY, h:mm a')
            |  in  
            = event.metadata.room
          h2
            a(href=event.url)= event.title
        section.content
          !{ typogr(event.intro).typogrify() }
          a(href=event.url + '#disqus_thread', data-disqus-identifier=event.url) Link
      .clearfix

  p.back
    a(href='#') Back To Top

block append scripts
  include includes/disqus
  +disqus_script('imperialacm')
